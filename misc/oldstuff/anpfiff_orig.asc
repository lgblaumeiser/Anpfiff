TOPIC:

  SCREEN CLOSE 1:WINDOW CLOSE 1
  CLS:SCREEN 1,640,256,3,2
  WINDOW 1,"AMIGA-Fu�ball-Manager",,0,1
  PRINT "Einen Moment bitte..."
  DIM na$(20),po$(20),zu$(20),TE$(18),tw$(18),E$(18),a(162),MN$(18),Vna$(13),Kaufko(13)
  DIM fa(20),ko(20),pu(18),pq(18),E(18),Lohnmo(18),Verkaufs(19),Vfa(13)
  DIM kn(18),ks(27),ka(27),TKON(18),Tore(18),INSTORE(18),HEIMTORE(18),IARSCH(19)
  DIM TABPUN(18),TOTOPUN(18),TABTORE(18),TABGETORE(18),GEWINN(18),Vpo$(13),STATITO2(20)
  DIM TOTOTIP(18),Team$(18),TPUN(18),TABGEPU(18),TGE(18),TBT(18),TGP(18),STATITO(20),zu(19)
  DIM Tito1(14),TBD(18),DIFFERENZ(18),TP(18),TPLATZ(18),TABEPLA(18),GELBE(19),TORKO(19),AM$(18)
  DIM STOPPER(19),LOST(18),WIN(18),EQUAL(18),L(18),K(18),H(18)
  GOSUB U1
  
Anfang:

  GOSUB Farben
  CLS:GOSUB MITTIG:LOCATE 14,8:ver=0:neg=0
  INPUT "Bitte geben Sie Ihren Namen ein: ",ma$
  COLOR 1,0
  FOR i = 1 TO 18
    zu=100:GOSUB zufallszahl
    E(i)=z
  NEXT i
  FOR i=1 TO 18
    FOR j=1 TO 18
      IF E(j)<E(i) THEN SWAP E(i),E(j):SWAP E$(i),E$(j)
    NEXT j
  NEXT i
  CLS:GOSUB USCH:LOCATE 3,30
  LINE (190,48)-(470,199),2,bf
  LINE (180,43)-(460,194),1,bf
  PRINT "T E A M A U S W A H L"
  FOR i=1 TO 18
    LOCATE 6+i,27
    PRINT i;TAB(33)E$(i)
  NEXT i
  LINE (230,214)-(430,231),2,bf
  LINE (220,209)-(420,226),1,bf
  LOCATE 28,36
  INPUT "IHRE WAHL: ",t:COLOR 1,0
  IF t>18 GOTO Anfang
  IF t<1  GOTO Anfang
  en$(1)=E$(1):E$(1)=E$(t):E$(t)=en$(1)
  FOR i=1 TO 18
    TE$(i)=E$(i)
    MN$(i)=TE$(i)
  NEXT i
  
Weitereins:

  FOR i=1 TO 16
    ko(i)=100:zu$(i)="OK"
  NEXT i
  ka=70000&:va=50000&:sp=1:bm=1:bms=1
  z=0:zu=30:RANDOMIZE TIMER
  z=2+INT(RND*(zu)+.5)
  ROTKAR=z
  GOTO MANAGERMARKT
  
mann:
Haupt:

  CLS:COLOR 0,1
  LINE (9,9)-(621,20),2,bf
  LINE (3,4)-(615,16),1,bf
  LOCATE 2,2
  PRINT "Mannschaftskonstellation:    ";TE$(1);:PRINT TAB(61)"Spieltag: ";sp
  PRINT
  GOSUB Mannschaftaufbau
  PRINT
  
Hau2:

  pa=0:pb=0:pc=0:pd=0:pd=0:pe=0:pf=0:pg=0:ph=0:kg=0
  FOR i=1 TO 11
    IF po$(i)="Torwart"    AND zu$(i)="OK" THEN pa=pa+fa(i):kg=kg+ko(i)
    IF po$(i)="Abwehr"     AND zu$(i)="OK" THEN pb=pb+fa(i):kg=kg+ko(i)
    IF po$(i)="Mittelfeld" AND zu$(i)="OK" THEN pc=pc+fa(i):kg=kg+ko(i)
    IF po$(i)="Angriff"    AND zu$(i)="OK" THEN pd=pd+fa(i):kg=kg+ko(i)
  NEXT i
  pg=pa+pb:ph=pc+pd
  ka(1)=pg:ks(1)=ph:kn(1)=kg
  IF SPPA1=1 THEN SPPA1=0:GOTO Hau3
  COLOR 0,1:SPIELFREI=1
  LINE   (9,226)-(153,236),2,bf
  LINE   (3,223)-(147,232),5,bf
  LINE (247,226)-(401,236),2,bf
  LINE (241,223)-(395,232),4,bf
  LINE (482,226)-(621,236),2,bf
  LINE (476,223)-(615,232),3,bf
  LOCATE 29,2: COLOR 2,5:PRINT "Abwehrst�rke:";pg
  LOCATE 29,32:COLOR 2,4:PRINT "Angriffst�rke:";ph
  LOCATE 29,61:COLOR 2,3:PRINT "Kondition:";kg
  LOCATE 27,27:COLOR 0,1
  LINE (205,210)-(430,220),2,bf
  LINE (199,207)-(424,216),1,bf
  PRINT " Wollen Sie wechseln (J/N)";Bes$
  COLOR 1,0
  SPPA=1
  
JaNein3:

  ver=3:neg=3
  GOSUB Abfrageschleife
  GOTO JaNein3
  
Noger3:

  ver=0:neg=0:MITTELAB=0
  FOR i=1 TO 11
    IF po$(i)="Mittelfeld" AND zu$(i)="OK" THEN MITTELAB=MITTELAB+1
    IF MITTELAB=2 THEN GOTO MANAGERMARKT
  NEXT i
  FOR i=12 TO 18
    IF po$(i)="Mittelfeld" AND zu$="OK" THEN
      CLS:GOSUB MITTIG:LOCATE 14,9
      PRINT "Sie m�ssen mindestens zwei Mittelfeldspieler aufbieten":GOSUB warten
      COLOR 1,0:GOTO Haupt
    END IF
  NEXT i
  GOTO MANAGERMARKT
  
Roger3:

  CLS:ma=1:GOSUB Mannschaftaufbau:ver=0:neg=0
  LINE  (64,213)-(164,224),4,bf:LOCATE 28,10:COLOR 2,4:PRINT "AUSWECHSELN"
  LINE (450,213)-(550,224),1,bf:LOCATE 28,58:COLOR 0,1:PRINT "EINWECHSELN"
  LINE (213,207)-(255,220),7,bf
  LINE (357,207)-(399,220),7,bf
  COLOR 2,7:LOCATE 27,29:INPUT "",sr
  IF sr<1 OR sr>18 OR sr>11 THEN BEEP:GOTO Roger3
  LINE  (64,213)-(164,226),1,bf
  LOCATE 28,10:COLOR 0,1:PRINT "AUSWECHSELN"
  LINE (450,213)-(550,224),5,bf
  LOCATE 28,58:COLOR 2,5:PRINT "EINWECHSELN"
  LOCATE 27,47:COLOR 2,7:INPUT "",ss
  IF ss>18 OR ss<1  OR ss<12 THEN BEEP:GOTO Roger3
  IF po$(sr)="Torwart" AND po$(ss)<>"Torwart" THEN BEEP:GOTO Roger3
  FOR i=1 TO 11
    IF po$(sr)<>"Torwart" AND po$(ss)="Torwart" THEN BEEP:GOTO Roger3
  NEXT i
  na$(19)=na$(sr):fa(19)=fa(sr):po$(19)=po$(sr):ko(19)=ko(sr):zu$(19)=zu$(sr):GELBE(19)=GELBE(sr):TORKO(19)=TORKO(sr):STOPPER(19)=STOPPER(sr):IARSCH(19)=IARSCH(sr):zu(19)=zu(sr)
  na$(sr)=na$(ss):fa(sr)=fa(ss):po$(sr)=po$(ss):ko(sr)=ko(ss):zu$(sr)=zu$(ss):GELBE(sr)=GELBE(ss):TORKO(sr)=TORKO(ss):STOPPER(sr)=STOPPER(ss):IARSCH(sr)=IARSCH(ss):zu(sr)=zu(ss)
  na$(ss)=na$(19):fa(ss)=fa(19):po$(ss)=po$(19):ko(ss)=ko(19):zu$(ss)=zu$(19):GELBE(ss)=GELBE(19):TORKO(ss)=TORKO(19):STOPPER(ss)=STOPPER(19):IARSCH(ss)=IARSCH(19):zu(ss)=zu(19)
  COLOR 1,0
  GOTO Haupt
  
Mannschaftaufbau:

  IF ma=1 THEN
    CLS:COLOR 0,1
    LOCATE 2,33
    LINE (205,6)-(425,20),2,bf
    LINE (200,1)-(420,15),1,bf
    PRINT "W E C H S E L"
  END IF
  COLOR 0,1
  LINE (9,28)-(621,204),2,bf
  LINE (3,23)-(615,200),1,bf
  LOCATE 4,2
  PRINT "Spielername und Nummer:"TAB(30)"Faktor:"TAB(39)"Kondition:"TAB(51)"Zustand:"TAB(61)"Position:":PRINT
  FOR i=1 TO 11
    LOCATE 5+i,2
    PRINT na$(i) TAB(17)"("i")"TAB(31) fa(i) TAB(40) ko(i) TAB(51) zu$(i) TAB(61) po$(i)
  NEXT i
  LOCATE 18,2
  PRINT "Auswechselspieler:"
  FOR i=12 TO 18
    IF na$(i)="" THEN ko(i)=0
    LOCATE 7+i,2
    PRINT na$(i) TAB(17)"("i")"TAB(31) fa(i) TAB(40) ko(i) TAB(51) zu$(i) TAB(61) po$(i)
  NEXT i
  COLOR 1,0
  IF ma=0 THEN RETURN
  COLOR 0,1
  LINE (266,207)-(SeasonManager.NUMBER_OF_GAME_DAYS6,235),5,bf
  LINE (266,207)-(306,235),7,b
  LINE (306,207)-(SeasonManager.NUMBER_OF_GAME_DAYS6,235),7,b
  LINE (266,212)-(280,230),7,b
  LINE (332,212)-(SeasonManager.NUMBER_OF_GAME_DAYS6,230),7,b
  CIRCLE (306,221),12,7
  LINE (212,206)-(256,221),7,bf
  LINE (212,206)-(256,221),2,b
  LINE (233,221)-(235,235),7,bf
  LINE (356,206)-(400,221),7,bf
  LINE (356,206)-(400,221),2,b
  LINE (377,221)-(379,235),7,bf
  LINE  (69,218)-(169,229),2,bf
  LINE (455,218)-(555,229),2,bf
  ma=0
  RETURN
  
Zufaelligkeit:

  kd=0
  IF sp<=2 THEN RETURN
  IF ka<=0 THEN RETURN
  zu=3:GOSUB zufallszahl
  ON z GOTO Pech,Glueck,Pech
  
Pech:

  IF ka <=100000& THEN zu=10:GOTO Ermit
  IF ka >=200000& THEN zu=30:GOTO Ermit
  IF ka >=400000& THEN zu=50:GOTO Ermit
  
Ermit:

  GOSUB zufallszahl
  kd=z*1000
  IF kd>ka THEN kd=ka
  RETURN

Glueck:

  RETURN
  
MANAGERMARKT:

  CLS:COLOR 0,1
  neg=0:ver=0:x=0
  FOR i=1 TO 5
    LINE  (20,15+x)-(310,35+x),2,bf
    LINE  (10,10+x)-(300,30+x),1,bf
    LINE (330,15+x)-(620,35+x),2,bf
    LINE (320,10+x)-(610,30+x),1,bf
    x=x+32
  NEXT i
  LINE (20,180)-(620,237),2,bf
  LINE (10,175)-(610,232),1,bf
  LOCATE  3, 8:PRINT "M A N A G E R M A R K T"
  LOCATE  3,44:PRINT "-1-  TOTOTIP"
  LOCATE  7, 5:PRINT "-2-  TRANSFERMARKT"
  LOCATE  7,44:PRINT "-3-  BAUMASSNAHMEN"
  LOCATE 11, 5:PRINT "-4-  TABELLE ZEIGEN"
  LOCATE 11,44:PRINT "-5-  SPIELERSTATUS ZEIGEN"
  LOCATE 15, 5:PRINT "-6-  N�CHSTEN GEGNER ZEIGEN"
  LOCATE 15,44:PRINT "-7-  MANNSCHAFT AUFSTELLEN"
  LOCATE 19, 5:PRINT "-8-  N�CHSTEN SPIELTAG ZEIGEN"
  LOCATE 19,44:PRINT "-9-  N�CHSTEN SPIELTAG SPIELEN"
  LOCATE 24, 5:PRINT "KAPITAL:       ";ka;:PRINT "DM"
  LOCATE 24,44:PRINT "SPIELTAG:      ";sp
  LOCATE 26, 5:PRINT "STADIONPL�TZE: ";va
  LOCATE 26,44:PRINT "MANAGERNAME:   ";ma$
  LOCATE 28, 5:PRINT "MANAGERFAKTOR: ";mf
  LOCATE 28,44:PRINT "IHRE WAHL:"
  LOCATE 28,57:INPUT "",a
  COLOR 1,0
  IF a>9 THEN GOTO MANAGERMARKT
  IF a<1 THEN GOTO MANAGERMARKT
  ON a GOTO TOTO,Transfer,Bau,Tabell,SPstatus,Gegner,mann,Tag,Spielen
  
Transfer:

  CLS:
  GOSUB USCH
  x=0
  FOR i=1 TO 5
    LINE (230,62+x)-(430,82+x),2,bf
    LINE (220,57+x)-(420,77+x),1,bf
    x=x+32
  NEXT i
  LOCATE  3,28:PRINT "T R A N S F E R M A R K T"
  LOCATE  9,31:PRINT "-1- Spieler kaufen"
  LOCATE 13,31:PRINT "-2- Spieler verkaufen"
  LOCATE 17,31:PRINT "-3- Spieler verleihen"
  LOCATE 21,31:PRINT "-4- Zur�ck"
  LOCATE 25,31:PRINT "Ihre Wahl:";:INPUT "",a
  IF a>4 GOTO Transfer
  IF a<1 GOTO Transfer
  COLOR 1,0
  ON a GOTO Spielerkauf,Spielerverkauf,Spielerverleih,MANAGERMARKT
  
Spielerkauf:

  IF kaufzaehler>=4 THEN
    CLS:GOSUB MITTIG
    LOCATE 14,5
    PRINT "Tut mir Leid, aber Sie k�nnen nur 4 Ausl�nder in Ihr Team aufnehmen !"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  IF KaufSp=0 THEN
    CLS:GOSUB MITTIG
    LOCATE 14,20
    PRINT "Zur Zeit k�nnen Sie keinen Spieler kaufen !"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  FOR i=1 TO 18
    IF na$(i)="" THEN GOTO Spielerkauf1
  NEXT i
  CLS
  GOSUB MITTIG
  LOCATE 14,23
  PRINT "Ihr Team besteht bereits aus 18 Spielern !"
  COLOR 1,0 
  GOSUB warten:GOTO MANAGERMARKT
  
Spielerkauf1:

  CLS:GOSUB USCH
  LOCATE 3,35:PRINT "K A U F E N"
  LINE (20,60)-(620,70),2,bf
  LINE (10,55)-(610,65),1,bf
  LOCATE 8,10
  PRINT "Name:"TAB(23)"Faktor:"TAB(SeasonManager.NUMBER_OF_GAME_DAYS)"Position:"TAB(49)"Kaufkosten:"
  Allright=sp
  IF Allright>13 THEN Allright=13
  Liva=Allright*9
  LINE (20,81)-(620,90+Liva),2,bf
  LINE (10,76)-(610,85+Liva-5),1,bf
  FOR i=1 TO Allright
    GOSUB Verkaufsauswertung
    LOCATE 10+i,5
    PRINT USING "##";i;:PRINT TAB(10) Vna$(i) TAB(27) Vfa(i) TAB(39) Vpo$(i) TAB(53) Kaufko(i)
  NEXT i
  LINE ( 20,227)-(235,237),2,bf
  LINE ( 10,222)-(225,232),1,bf
  LINE (285,227)-(615,237),2,bf
  LINE (275,222)-(605,232),1,bf
  LOCATE 29, 5:PRINT "Kapital: ";ka;:PRINT "DM"
  LOCATE 29,37:PRINT "Welchen Spieler wollen Sie kaufen ?"
  LOCATE 29,73:INPUT "",a
  COLOR 1,0
  IF a<1        THEN GOTO Spielerkauf1
  IF a>Allright THEN GOTO Spielerkauf1
  IF Kaufko(a)>ka THEN
    CLS
    GOSUB MITTIG
    LOCATE 14,7
    PRINT "Sie haben nicht genug Kapital, um den Spieler kaufen zu k�nnen !"
    COLOR 1,0:GOSUB warten:GOTO Transfer
  END IF
  FOR i=1 TO 18
    IF na$(i)="" THEN GOTO Spuebergeben
  NEXT i
  GOSUB warten:GOTO Transfer

Spuebergeben:

  na$(i)=Vna$(a):po$(i)=Vpo$(a):fa(i)=Vfa(a):zu$(i)="OK":ko(i)=100:STOPPER(i)=0
  FOR i=2 TO 6
    IF Vfa(a)=i THEN mf=mf+i
  NEXT i
  ka=ka-Kaufko(a):Vna$(a)="Verkauft":Vpo$(a)="":Vfa(a)=0:Kaufko(a)=0:KaufSp=0
  CLS:GOSUB MITTIG:LOCATE 14,8:kaufzaehler=kaufzaehler+1
  PRINT "Sie haben nun den ";:PRINT USING "#.";kaufzaehler;:PRINT " von 4 m�glichen Ausl�ndern in Ihrem Team !"
  GOSUB warten:COLOR 1,0:GOTO MANAGERMARKT
  
Verkaufsauswertung:

  IF Vfa(i)=2 THEN Kaufko(i)= 80000&
  IF Vfa(i)=3 THEN Kaufko(i)=200000&
  IF Vfa(i)=4 THEN Kaufko(i)=300000&
  IF Vfa(i)=5 THEN Kaufko(i)=450000&
  IF Vfa(i)=6 THEN Kaufko(i)=600000&
  
  RETURN
  
Spielerverkauf:

  IF VerkaufSP=0 THEN
    CLS:GOSUB MITTIG
    LOCATE 14,20
    PRINT "Zur Zeit k�nnen Sie keinen Spieler verkaufen !"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  CLS:GOSUB USCH
  LOCATE 3,32
  PRINT "V E R K A U F E N"
  LINE (18,50)-(620,60),2,bf
  LINE ( 8,45)-(610,55),1,bf
  LOCATE 7,5
  PRINT "Name" TAB(21) "F" TAB(27) "Position" TAB(42) "Kon" TAB(55) "Preis" TAB(69) "Lohn"
  GOSUB MITTIG
  LOCATE 14,31:PRINT "EINEN MOMENT BITTE..."
  GOSUB LWBerechnung
  LINE (18,71)-(620,236),2,bf
  LINE ( 8,66)-(610,231),1,bf
  FOR i=1 TO 18
    LOCATE 9+i,2
    PRINT USING "##";i;
    PRINT TAB(5) na$(i) TAB(20) fa(i) TAB(27) po$(i) TAB(41) ko(i) TAB(54) Verkaufs(i) TAB(68) Lohnmo(i)
  NEXT i
  PRINT:COLOR 2,1:PRINT TAB(2):PRINT"Kapital:";ka;"DM";:PRINT TAB(28):INPUT "Welchen Spieler m�chten Sie verkaufen ?",a
  COLOR 1,0
  IF a<1  THEN GOTO Spielerverkauf
  IF a>18 THEN GOTO Spielerverkauf
  FOR i=1 TO 18
    IF po$(i)="Mittelfeld" THEN Pruefsumme=Pruefsumme+1
    IF po$(i)="Torwart"    THEN ABCHECK=ABCHECK+1
  NEXT i
  IF po$(a)="Mittelfeld" AND Pruefsumme<=2 THEN
    CLS:GOSUB MITTIG:LOCATE 14,6
    PRINT "Tut mir Leid, aber Sie m�ssen mindestens 2 Mittelfeldspieler haben !"
    GOSUB warten:COLOR 1,0:Pruefsumme=0:GOTO Spielerverkauf
  END IF
  IF po$(a)="Torwart" AND ABCHECK<=2 THEN
    CLS:GOSUB MITTIG:LOCATE 14,9
    PRINT "Tut mir Leid, aber Sie m�ssen mindestens 2 Torh�ter haben !"
    COLOR 1,0:GOSUB warten:ABCHECK=0:GOTO Spielerverkauf
  END IF 
  IF zu$(a)="verliehen" THEN
    CLS:GOSUB MITTIG:LOCATE 14,13
    PRINT "Sie k�nnen keinen verliehenen Spieler verkaufen"
    COLOR 1,0:GOSUB warten:GOTO Spielerverkauf
  END IF 
  CLS:GOSUB MITTIG:LOCATE 14,25
  PRINT "M�chten Sie wirklich verkaufen ";Bes$
  COLOR 1,0
  
JaNein5:

  ver=5:neg=5
  GOSUB Abfrageschleife
  GOTO JaNein5
  
Roger5:

  neg=0:ver=0
  FOR i=1 TO 13
    IF Vna$(i)="Verkauft" THEN Vna$(i)=na$(a):Vpo$(i)=po$(a):Vfa(i)=fa(a):GOTO nureiner:
  NEXT i
  
nureiner:

  na$(a)="":po$(a)="":fa(a)=0:zu$(a)="":ko(a)=0:TORKO(a)=0:GELBE(a)=0  
  ka=ka+Verkaufs(a):VerkaufSP=0:Verkaufs(a)=0:Lohnmo(a)=0
  CLS:GOSUB MITTIG:LOCATE 14,28
  PRINT "OK, Spieler ist verkauft":COLOR 1,0:GOSUB warten
  GOTO MANAGERMARKT
  
Spielerverleih:

  Zzahl=0
  IF VerleihSp=0 THEN
    CLS:GOSUB MITTIG:LOCATE 14,17
    PRINT "Zur Zeit k�nnen Sie keinen Spieler verleihen !"
    COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  END IF
  FOR i=1 TO 18
    IF na$(i)="" THEN Zzahl=i:GOTO Spverleih2
  NEXT i
  
Spverleih2:
  
  IF Zzahl=0 THEN Zzahl=18
  zu=Zzahl:GOSUB zufallszahl
  IF na$(z)=""   THEN      GOTO Spverleih2
  IF zu$(z)="OK" THEN AB=z:GOTO Spverleih3
  GOTO Spverleih2
  
Spverleih3:

  CLS:GOSUB USCH:LOCATE 3,24
  PRINT "S P I E L E R   V E R L E I H E N"
  LINE (230,62)-(430,82),2,bf
  LINE (220,57)-(420,77),1,bf
  LOCATE 9,33
  PRINT "Kapital:";ka;:PRINT "DM":zu=17
  
Teauslo:

  GOSUB Teauslosung
  IF TE$(z)=TE$(1) THEN GOTO Teauslo
  LINE (92,109)-(540,195),2,bf
  LINE (83,104)-(530,190),1,bf
  LOCATE 15,14
  LINE (92,217)-(540,232),2,bf
  LINE (83,212)-(530,190),1,bf
  PRINT "T E L E X :":LOCATE 17,22
  PRINT TE$(z):LOCATE 19,30
  PRINT "bietet f�r den Spieler"
  LOCATE 21,38:PRINT na$(AB)
  IF fa(AB)=2 THEN Verleihko= 60000&
  IF fa(AB)=3 THEN Verleihko= 90000&
  IF fa(AB)=4 THEN Verleihko=130000&
  IF fa(AB)=5 THEN Verleihko=180000&
  IF fa(AB)=6 THEN Verleihko=220000&
  LOCATE 23,46:PRINT Verleihko;:PRINT "DM"
  LOCATE 28,28
  PRINT "Nehmen Sie dieses Angebot an ?";Bes$
  COLOR 1,0
  
JaNein6:

  ver=6:neg=6
  GOSUB Abfrageschleife
  GOTO JaNein6
  
Roger6:

  neg=0:ver=0:zu$(AB)="verliehen":ka=ka+Verleihko:AB=0:VerleihSp=0
  CLS:GOSUB MITTIG:LOCATE 14,14
  PRINT "O.K., der Spieler wird f�r einen Spieltag verliehen"
  COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
Teauslosung:

  z=0:RANDOMIZE TIMER
  z=2+INT(RND*(zu)):RETURN
  
TOTO:

  IF TOTOTIPPEN=1 THEN
    CLS:GOSUB MITTIG:LOCATE 14,28
    PRINT "Sie haben bereits getippt":COLOR 1,0:GOSUB warten
    GOTO MANAGERMARKT
  END IF
  IF ka<10000 THEN
    CLS:GOSUB MITTIG:LOCATE 14,20
    PRINT "Sie haben nicht gen�gend Geld zum Tippen":COLOR 1,0:GOSUB warten
    GOTO MANAGERMARKT
  END IF
  CLS:GOSUB USCH:LOCATE 3,SeasonManager.NUMBER_OF_GAME_DAYS
  PRINT "T O T O T I P"
  LINE (20,1SeasonManager.NUMBER_OF_GAME_DAYS)-(310,154),2,bf
  LINE (10,129)-(300,149),1,bf
  LINE (20, 60)-(620, 80),2,bf
  LINE (10, 55)-(610, 75),1,bf
  LOCATE 9,4
  PRINT "Mannschaft:" TAB(25) "Platz:" TAB(35) "Mannschaft:" TAB(60) "Platz:" TAB(70) "Tip:"
  LOCATE 18,4
  PRINT "Kapital:";ka;:PRINT "DM"
  FOR i=1 TO 17 STEP 2
    FOR j=1 TO 18
      IF Team$(j)=TE$(a(i))   THEN Plaz1=j
      IF Team$(j)=TE$(a(i+1)) THEN Plaz2=j
    NEXT j
    
    AGAIN:
    
    GOSUB MITTIG:LOCATE 14,4
    PRINT TE$(a(i)) TAB(25) "(";:PRINT USING "##.";Plaz1;:PRINT ")";
    PRINT TAB(33) "-" TAB(35) TE$(a(i+1)) TAB(60):PRINT "(";:
    PRINT USING "##.";Plaz2;:PRINT ")" TAB(70):INPUT "",TOTOTIP(a(i))
    IF TOTOTIP(a(i))>2 THEN BEEP:GOTO AGAIN
    IF TOTOTIP(a(i))<0 THEN BEEP:GOTO AGAIN
  NEXT i
  
TOTOFR:

  LINE (20,174)-(620,194),2,bf
  LINE (10,169)-(610,189),1,bf
  LOCATE 23,4
  INPUT "Ihr Einsatz (in Tausend);  >10000 und <25000 DM   ",MON
  IF MON>25 OR MON<10 THEN BEEP:GOTO TOTOFR
  kapi=ka:MONETE=MON*1000:PRu=kapi-MONETE
  IF PRu<0 THEN BEEP:GOTO TOTOFR
  ka=ka-MONETE
  COLOR 1,0
  CLS:GOSUB MITTIG:LOCATE 14,27
  PRINT "O.K. Ihr Einsatz wird notiert !":GOSUB warten:COLOR 1,0:TOTOTIPPEN=1:GOTO MANAGERMARKT
  
Tag:

  CLS:LOCATE 3,33:GOSUB USCH
  PRINT "N�CHSTER SPIELTAG"
  LINE (47,48)-(596,199),2,bf
  LINE (37,43)-(586,194),1,bf
  FOR i=1 TO 17 STEP 2
    FOR j=1 TO 18
      IF Team$(j)=TE$(a(i))   THEN Plaz1=j
      IF Team$(j)=TE$(a(i+1)) THEN Plaz2=j
    NEXT j
    LOCATE 6+i,11
    PRINT TE$(a(i)) TAB(33) "(";:PRINT USING "##.";Plaz1;:PRINT ")" TAB(39) "-" TAB(41) TE$(a(i+1)) TAB(65):PRINT "(";:PRINT USING "##.";Plaz2;:PRINT ")"
  NEXT i
  LINE (230,214)-(430,231),2,bf
  LINE (220,209)-(420,226),1,bf
  LOCATE 28,38
  PRINT "Taste":COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
Gegner:

  CLS:GOSUB USCH:LOCATE 3,25
  PRINT "N � C H S T E R   G E G N E R"
  LINE (230,62)-(430,82),2,bf
  LINE (220,57)-(420,77),1,bf
  
Hau3:

  IF SPPA=0 THEN SPPA=1:SPPA1=1:GOTO Hau2
  LOCATE 9,36
  PRINT "Spieltag";sp
  
PLKJ:

  GOSUB MITTIG
  LOCATE 14,3
  FOR i=1 TO 17 STEP 2
    IF TE$(a(i))  =TE$(1) THEN PRINT TAB(15) TE$(1)    TAB(40)"-" TAB(47) TE$(a(i+1)):NF=a(i+1)
    IF TE$(a(i+1))=TE$(1) THEN PRINT TAB(15) TE$(a(i)) TAB(40)"-" TAB(47) TE$(1)     :NF=a(i)
  NEXT i
  FOR i=1 TO 18
    IF Team$(i)=TE$(NF) THEN TPla =i
    IF Team$(i)=TE$(1)  THEN TPla1=i
  NEXT i
  GOSUB GEGTAF
  LOCATE 18,4
  COLOR 2,1
  PRINT "GEGNER:";:PRINT TAB(12):PRINT USING "##";TPla ;:PRINT ".";:PRINT TAB(24):COLOR 2,5:PRINT "ABWEHR:";ka(NF);:PRINT TAB(44):COLOR 2,4:PRINT "ANGRIFF:";ks(NF);:PRINT TAB(62):COLOR 2,3
  PRINT "KONDITION";kn(NF)
  LOCATE 22,4
  COLOR 2,1
  PRINT "TEAM:"  ;:PRINT TAB(12):PRINT USING "##";TPla1;:PRINT ".";:PRINT TAB(24):COLOR 2,5:PRINT "ABWEHR:";ka(1); :PRINT TAB(44):COLOR 2,4:PRINT "ANGRIFF:";ks(1) ;:PRINT TAB(62):COLOR 2,3
  PRINT "KONDITION";kn(1)
  COLOR 0,1
  WHILE sp>17
    FOR i=18 TO SeasonManager.NUMBER_OF_GAME_DAYS STEP 2
      LOCATE 26,SeasonManager.NUMBER_OF_GAME_DAYS
      IF sp=i THEN PRINT "H I N R U N D E":LOCATE 28,38:PRINT STATITO2(sp-17);:PRINT TAB(41):PRINT ":";:PRINT TAB(42):PRINT STATITO(sp-17)
    NEXT i
    FOR i=19 TO 33 STEP 2
      IF sp=i THEN PRINT "H I N R U N D E":LOCATE 28,38:PRINT STATITO(sp-17);:PRINT TAB(41):PRINT ":";:PRINT TAB(42):PRINT STATITO2(sp-17)
    NEXT i
    GOTO DOEDEL
  WEND
  LOCATE 27,37:PRINT "T A S T E"
  
DOEDEL:
  
  NF=0:COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
GEGTAF:

  LINE ( 20,1SeasonManager.NUMBER_OF_GAME_DAYS)-(140,154),2,bf
  LINE ( 10,129)-(130,149),1,bf
  LINE ( 20,167)-(140,187),2,bf
  LINE ( 10,162)-(130,182),1,bf
  LINE (170,1SeasonManager.NUMBER_OF_GAME_DAYS)-(300,154),2,bf
  LINE (160,129)-(290,149),5,bf
  LINE (170,167)-(300,187),2,bf
  LINE (160,162)-(290,182),5,bf
  LINE (330,1SeasonManager.NUMBER_OF_GAME_DAYS)-(460,154),2,bf
  LINE (320,129)-(450,149),4,bf
  LINE (330,167)-(460,187),2,bf
  LINE (320,162)-(450,182),4,bf
  LINE (230,202)-(430,231),2,bf
  LINE (220,197)-(420,226),1,bf
  LINE (490,1SeasonManager.NUMBER_OF_GAME_DAYS)-(620,154),2,bf
  LINE (480,129)-(610,149),3,bf
  LINE (490,167)-(620,187),2,bf
  LINE (480,162)-(610,182),3,bf
  
  RETURN
  
LWBerechnung:

  FOR i=1 TO 18
    IF TORKO(i)>=0 AND fa(i)=0 THEN Lohnmo(i)=0   :Verkaufs(i)=0
    IF TORKO(i)>=0 AND fa(i)=2 THEN Lohnmo(i)=1000:Verkaufs(i)=90000&
    IF TORKO(i)>=0 AND fa(i)=3 THEN Lohnmo(i)=1300:Verkaufs(i)=150000&
    IF TORKO(i)>=0 AND fa(i)=4 THEN Lohnmo(i)=1800:Verkaufs(i)=230000&
    IF TORKO(i)>=0 AND fa(i)=5 THEN Lohnmo(i)=2500:Verkaufs(i)=500000&
    IF TORKO(i)>=0 AND fa(i)=6 THEN Lohnmo(i)=4000:Verkaufs(i)=600000&
  NEXT i
  FOR i=1 TO 18
    IF TORKO(i)>=0 AND fa(i)=0 THEN Lohnmo(i)=0   :Verkaufs(i)=0
    IF TORKO(i)>=2 AND fa(i)=2 THEN Lohnmo(i)=1200:Verkaufs(i)=120000&
    IF TORKO(i)>=2 AND fa(i)=3 THEN Lohnmo(i)=1700:Verkaufs(i)=200000&
    IF TORKO(i)>=2 AND fa(i)=4 THEN Lohnmo(i)=2300:Verkaufs(i)=300000&
    IF TORKO(i)>=2 AND fa(i)=5 THEN Lohnmo(i)=3000:Verkaufs(i)=600000&
    IF TORKO(i)>=2 AND fa(i)=6 THEN Lohnmo(i)=4500:Verkaufs(i)=700000&
  NEXT i
  FOR i=1 TO 18
    IF TORKO(i)>=0 AND fa(i)=0 THEN Lohnmo(i)=0   :Verkaufs(i)=0
    IF TORKO(i)>=4 AND fa(i)=2 THEN Lohnmo(i)=2100:Verkaufs(i)=300000&
    IF TORKO(i)>=4 AND fa(i)=3 THEN Lohnmo(i)=2900:Verkaufs(i)=400000&
    IF TORKO(i)>=4 AND fa(i)=4 THEN Lohnmo(i)=3500:Verkaufs(i)=550000&
    IF TORKO(i)>=4 AND fa(i)=5 THEN Lohnmo(i)=5000:Verkaufs(i)=900000&
    IF TORKO(i)>=4 AND fa(i)=6 THEN Lohnmo(i)=7500:Verkaufs(i)=1000000&
  NEXT i
  FOR i=1 TO 18
    IF TORKO(i)>=0 AND fa(i)=0 THEN Lohnmo(i)=0   :Verkaufs(i)=0
    IF TORKO(i)>=6 AND fa(i)=2 THEN Lohnmo(i)=3000:Verkaufs(i)=350000&
    IF TORKO(i)>=6 AND fa(i)=3 THEN Lohnmo(i)=4000:Verkaufs(i)=480000&
    IF TORKO(i)>=6 AND fa(i)=4 THEN Lohnmo(i)=5500:Verkaufs(i)=650000&
    IF TORKO(i)>=6 AND fa(i)=5 THEN Lohnmo(i)=7500:Verkaufs(i)=1300000&
    IF TORKO(i)>=6 AND fa(i)=6 THEN Lohnmo(i)=9000:Verkaufs(i)=1500000&
  NEXT i
  FOR i=1 TO 18
    IF zu$(i)="Spital" AND IARSCH(i)=1 THEN Verkaufs(i)=Verkaufs(i)/2:mf=mf-10
  NEXT i
  
  RETURN
  
SPstatus:

  CLS:GOSUB MITTIG:LOCATE 14,31
  PRINT "EINEN MOMENT BITTE...":GOSUB LWBerechnung:COLOR 1,0
  CLS:GOSUB USCH:LOCATE 3,28
  PRINT "S P I E L E R S T A T U S"
  LINE (18,50)-(620,60),2,bf
  LINE ( 8,45)-(610,55),1,bf
  LOCATE 7,3
  PRINT "Name:" TAB(15) "Gelbe:" TAB(25) "Tore:" TAB(35) "Faktor:" TAB(45) "Lohnkosten:" TAB(60) "Verkaufswert:"
  LINE (18,71)-(620,236),2,bf
  LINE ( 8,66)-(610,231),1,bf
  FOR i=1 TO 18
    LOCATE 9+i,3
    PRINT na$(i) TAB(16) GELBE(i) TAB(26) TORKO(i) TAB(36) fa(i) TAB(46) Lohnmo(i) TAB(61) Verkaufs(i)
  NEXT i
  COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
Tabell:
  
  IF sp=1 THEN
    CLS:GOSUB MITTIG:LOCATE 14,20
    PRINT "Es hat noch kein Spieltag stattgefunden"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  Tabaus=1:sp=sp-1:GOSUB TABELLE:sp=sp+1:Tabaus=0
  GOTO MANAGERMARKT
  
Bau:

  IF sp=1 THEN GOTO Verw
  IF bmst=1 THEN
    CLS:GOSUB MITTIG:LOCATE 14,25
    PRINT "Im Stadion wird momentan noch ausgebaut"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  IF ka<5000 THEN
    CLS:GOSUB MITTIG:LOCATE 14,10
    PRINT "Sie bringenf�r einen Ausbau nicht gen�gend Kapital auf "
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  IF bms=0 THEN GOTO RAUSWERFEN
  IF bm =1 THEN GOTO baum
  
RAUSWERFEN:

  CLS:GOSUB MITTIG:LOCATE 14,7
  PRINT "Sie k�nnen an jedem Spieltag nur einmal den Baumarkt besuchen"
  COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
baum:

  IF va>=100000& THEN
    CLS:GOSUB MITTIG:LOCATE 14,14
    PRINT "Ihr Stadion kann nicht weiter ausgebaut werden"
    COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  END IF
  zu=4:GOSUB zufallszahl
  ON z GOTO Bam,Verw,Bam,Bam
  
Bam:
  
  CLS:GOSUB USCH:LOCATE 3,28
  PRINT "B A U M A S S N A H M E N"
  LINE (82,48)-(540,195),2,bf
  LINE (72,43)-(530,190),1,bf
  LOCATE 9,14
  LINE (82,217)-(540,232),2,bf
  LINE (72,212)-(530,227),1,bf
  PRINT "Kapital:                     ";ka" DM"
  LOCATE 12,14
  PRINT "Fassungsverm�gen momentan:   ";va" Zuschauer"
  LOCATE 14,14
  PRINT "Stadionausbau maximal:        100.000 Pl�tze"
  LOCATE 16,14
  PRINT "Bauauftrag minimal:           5.000 Pl�tze"
  LOCATE 18,14
  PRINT "Bauauftrag maximal:           10.000 Pl�tze"
  LOCATE 20,14
  PRINT "Preis f�r 5.000 Pl�tze:       50.000 DM
  LOCATE 22,14
  PRINT "Dauer des Ausbaus:            4 Spieltage"
  
VEla:

  LOCATE 28,14
  INPUT "Wieviele Pl�tze wollen Sie kaufen (in Tausend) ";P
  IF P>10 THEN GOTO VEla
  WQ=P:WQ=WQ*10000
  IF WQ>ka THEN BEEP:GOTO VEla
  IF P<5 OR P>10 THEN BEEP:GOTO VEla
  P=P*1000:vb=va+P
  IF vb<=100000& THEN      GOTO Bauaus
  IF vb>=100000& THEN BEEP:GOTO VEla
  
Bauaus:

  bmst=1:FERTIG=sp+4:PP=P:ka=ka-WQ:bms=0:PRINT:vb=0
  COLOR 1,0:CLS:GOSUB MITTIG:LOCATE 14,21
  PRINT "In Ordnung, Ihr Stadium wird umgehend ausgebaut !"
  COLOR 1,0:GOSUB warten:GOTO MANAGERMARKT
  
Verw:

  CLS:GOSUB MITTIG:LOCATE 14,4
  PRINT "Bauauftr�ge lassen es zur Zeit nicht zu, das Sie Ihr Stadion ausbauen"
  bms=0:COLOR 1,0
  GOSUB warten:GOTO MANAGERMARKT
  
UEEINSCHUB:

  CLS:GOSUB USCH:LOCATE 3,SeasonManager.NUMBER_OF_GAME_DAYS
  PRINT "U E F A - C U P"
  LINE (230,62)-(430,82),2,bf
  LINE (220,57)-(420,77),1,bf
  IF sp=11 OR sp=14 THEN GOTO maleue1
  IF sp=20 OR sp=23 THEN GOTO maleue2
  IF sp=29 OR sp=32 THEN GOTO maleue3
  LINE (47,99)-(596,2SeasonManager.NUMBER_OF_GAME_DAYS),2,bf
  LINE (37,94)-(586,229),1,bf
  GOTO springback
  
maleue1:

  LINE (47,99)-(596,170),2,bf
  LINE (37,94)-(586,165),1,bf
  GOTO springback
  
maleue2:

  LINE (47,99)-(596,136),2,bf
  LINE (37,94)-(586,131),1,bf
  GOTO springback
  
maleue3:

  LINE (47,99)-(596,122),2,bf
  LINE (37,94)-(586,117),1,bf
  
springback:

  RETURN
  
Bank:
Spielen:

  IF SPIELFREI=0 THEN
    CLS:GOSUB MITTIG:LOCATE 14,6
    PRINT "Vor einem Spieltag m�ssen Sie einmal nach Ihrer Mannschaft sehen"
    COLOR 1,0
    GOSUB warten:GOTO MANAGERMARKT
  END IF
  IF sp=1 THEN
    CLS:GOSUB MITTIG:LOCATE 14,31
    PRINT "EINEN MOMENT BITTE...":COLOR 1,0
  END IF
  
Bundesliga:

  FOR i=1 TO 18
    MN$(i)=Team$(i)
  NEXT i
  FOR i=1 TO 18 STEP 2
    r=(a(i)):o=(a(i+1))
    TKON(r)=0:TKON(o)=0:HEIMTORE(r)=0
    zu=1:GOSUB zufalleins
    IF z=0 THEN GOTO Spielwertung
    IF z=1 THEN GOTO KONDITIONSTOR
    
    KONDITIONSTOR:
    
    IF kn(r) > kn(o) THEN TKON(r)=1
    IF kn(r) = kn(o) THEN TKON(r)=1
    IF kn(r) < kn(o) THEN TKON(o)=1
    
    Spielwertung:
    
    TOR=ks(r)-ka(o)
    WHILE TOR > 0
      IF TOR>9 THEN TOR=9
      GOSUB plusto
      Tore(r)=plto
      GOTO weitermachen
    WEND
    WHILE TOR = 0
      zu=1:GOSUB zufalleins
      IF z=0 THEN Tore(r)=1
      IF z=1 THEN Tore(r)=0
      GOTO weitermachen
    WEND
    WHILE TOR < 0
      GOSUB minusto
      Tore(r)=mito
      GOTO weitermachen
    WEND
    
    weitermachen:
    
    TOR=ks(o)-ka(r)
    WHILE TOR > 0
      IF TOR>9 THEN TOR=9
      GOSUB plusto
      Tore(o)=plto
      GOTO weiterimtext
    WEND
    WHILE TOR = 0
      zu=1:GOSUB zufalleins
      IF z=0 THEN Tore(o)=1
      IF z=1 THEN Tore(o)=0
      GOTO weiterimtext
    WEND
    WHILE TOR < 0
      GOSUB minusto
      Tore(o)=mito
      GOTO weiterimtext
    WEND
    
    weiterimtext:
    
    zu=1:GOSUB zufalleins
    IF z=1 THEN HEIMTORE(r)=1
    IF z=2 THEN HEIMTORE(r)=0
    WHILE sp=1
      zu=1:GOSUB zufalleins
      IF z=1 THEN Tore(r)=Tore(r)+1
      IF z=2 THEN Tore(o)=Tore(o)+1
      GOTO auswertenSp
    WEND
    
    auswertenSp:
    
    INSTORE(r)=Tore(r)+TKON(r)+HEIMTORE(r)
    INSTORE(o)=Tore(o)+TKON(o)
    WHILE TE$(r)=E$(1)
      IF INSTORE(o)=0 THEN GOTO SDF
      IF INSTORE(r)<3 THEN GOTO SDF
      zu=1:GOSUB zufalleins
      IF z=1 THEN INSTORE(r)=INSTORE(r)-1:INSTORE(o)=INSTORE(o)-1
      GOTO SDF
    WEND
    
    SDF:
    
    WHILE TE$(o)=E$(1)
      IF INSTORE(r)=0 THEN GOTO SDT
      IF INSTORE(o)<3 THEN GOTO SDT
      zu=1:GOSUB zufalleins
      IF z=1 THEN INSTORE(o)=INSTORE(o)-1:INSTORE(r)=INSTORE(r)-1
      GOTO SDT
    WEND
    
    SDT:
    
    IF TE$(r)=E$(1) THEN GESCHOSS=INSTORE(r)
    IF TE$(o)=E$(1) THEN GESCHOSS=INSTORE(o)
    WHILE INSTORE(r)>INSTORE(o)
      IF TE$(r)=E$(1) THEN mf=mf+2
      WIN(r) =WIN(r) +1
      LOST(o)=LOST(o)+1
      TABPUN(r)=TABPUN(r)+2
      TOTOPUN(r)=1
      TABTORE(r)=TABTORE(r)+INSTORE(r)
      TABGEPU(o)=TABGEPU(o)+2
      TABTORE(o)=TABTORE(o)+INSTORE(o)
      AB=INSTORE(o)
      TABGETORE(r)=TABGETORE(r)+AB
      abc=TABGETORE(r)
      ac=INSTORE(r)
      TABGETORE(o)=TABGETORE(o)+ac
      acd=TABGETORE(o)
      DIFFERENZ(o)=TABTORE(o)-acd
      DIFFERENZ(r)=TABTORE(r)-abc
      GOTO weitergehen
    WEND
    WHILE INSTORE(r)<INSTORE(o)
      IF TE$(o)=E$(1) THEN mf=mf+1
      WIN(o) =WIN(o) +1
      LOST(r)=LOST(r)+1
      TABPUN(o)=TABPUN(o)+2
      TOTOPUN(r)=2
      TABTORE(r)=TABTORE(r)+INSTORE(r)
      TABGEPU(o)=TABGEPU(o)+0
      TABGEPU(r)=TABGEPU(r)+2
      TABTORE(o)=TABTORE(o)+INSTORE(o)
      ac=INSTORE(r)
      TABGETORE(o)=TABGETORE(o)+ac
      acd=TABGETORE(o)
      AB=INSTORE(o)
      TABGETORE(r)=TABGETORE(r)+AB
      abc=TABGETORE(r)
      DIFFERENZ(r)=TABTORE(r)-abc
      DIFFERENZ(o)=TABTORE(o)-acd
      GOTO weitergehen
    WEND
    WHILE INSTORE(r)=INSTORE(o)
      IF TE$(r)=E$(1) OR TE$(o)=E$(1) THEN mf=mf+1
      EQUAL(r)=EQUAL(r)+1
      EQUAL(o)=EQUAL(o)+1
      TABPUN(r)=TABPUN(r)+1
      TABPUN(o)=TABPUN(o)+1
      TOTOPUN(r)=0
      TABGEPU(o)=TABGEPU(o)+1
      TABGEPU(r)=TABGEPU(r)+1
      TABTORE(r)=TABTORE(r)+INSTORE(r)
      TABGETORE(r)=TABGETORE(r)+INSTORE(o)
      TABTORE(o)=TABTORE(o)+INSTORE(o)
      TABGETORE(o)=TABGETORE(o)+INSTORE(r)
      DIFFERENZ(r)=TABTORE(r)-TABGETORE(r)
      DIFFERENZ(o)=TABTORE(o)-TABGETORE(o)
      GOTO weitergehen
    WEND
    
    weitergehen:
    
    WHILE TOTOTIPPEN=1
      IF TOTOPUN(r)=TOTOTIP(r) THEN GEWINN=GEWINN+1
      GOTO weitergehen2
    WEND
    
    weitergehen2:
    
    WHILE sp<18
      IF TE$(r)=E$(1) THEN STATITO(sp)=INSTORE(r):STATITO2(sp)=INSTORE(o)
      IF TE$(o)=E$(1) THEN STATITO(sp)=INSTORE(o):STATITO2(sp)=INSTORE(r)
      GOTO DODOIT
    WEND
    
    DODOIT:
    
  NEXT i
  
  CLS
  COLOR 1,0
  CLS:GOSUB USCH:LOCATE 3,28
  PRINT "E N D E R G E B N I S S E"
  LINE ( 47, 48)-(596,199),2,bf
  LINE ( 37, 43)-(586,194),1,bf
  LINE (230,214)-(430,2SeasonManager.NUMBER_OF_GAME_DAYS),2,bf
  LINE (220,209)-(420,229),1,bf
  FOR i=1 TO 18 STEP 2
    r=(a(i)):o=(a(i+1))
    LOCATE 6+i,11
    PRINT TE$(r) TAB(SeasonManager.NUMBER_OF_GAME_DAYS) "-" TAB(38) TE$(o) TAB(62); INSTORE(r) TAB(65);":" TAB(66) INSTORE(o)
  NEXT i
  SPIELFREI=0
  FOR i=1 TO 18
    Team$(i)=TE$(i)
    TPUN(i)=TABPUN(i)
    TGE(i)=TABGETORE(i)
    TBT(i)=TABTORE(i)
    TGP(i)=TABGEPU(i)
    TBD(i)=DIFFERENZ(i)
    L(i)=LOST(i)
    K(i)=EQUAL(i)
    H(i)=WIN(i)
    INSTORE(i)=0
    IF sp=1 THEN MN$(i)=Team$(i)
  NEXT i
  FOR i=1 TO 5
    LOCATE 28,35
    PRINT "            "
    FOR j=1 TO 250:NEXT j
    LOCATE 28,35
    PRINT "Bitte warten"
    FOR j=1 TO 200:NEXT j
  NEXT i
  FOR i=1 TO 18
    FOR j=1 TO 18
      IF TPUN(j)<TPUN(i) THEN
        SWAP TPUN(i), TPUN(j)
        SWAP TP(i),   TP(j)
        SWAP Team$(i),Team$(j)
        SWAP TGE(i),  TGE(j)
        SWAP TGP(i),  TGP(j)
        SWAP TBT(i),  TBT(j)
        SWAP TBD(i),  TBD(j)
        SWAP H(i),    H(j)
        SWAP K(i),K(j)
        SWAP L(i),L(j)
      END IF
      IF TPUN(j)=TPUN(i) THEN
        GOSUB VERGLEICHEN
      END IF
    NEXT j
  NEXT i
  LOCATE 28,35:PRINT "  Taste          "
  GOSUB warten
  COLOR 1,0
  
TABELLE:

  CLS:GOSUB USCH:LOCATE 3,SeasonManager.NUMBER_OF_GAME_DAYS
  PRINT "T A B E L L E"
  LINE (16,50)-(630,60),2,bf
  LINE ( 6,45)-(620,55),1,bf
  LOCATE 7,2
  PRINT "Pl  von    Mannschaft              Punkte    Tore    Dif    Gew    Un    Ver":PRINT
  LINE (16,71)-(630,226),2,bf
  LINE ( 6,66)-(620,221),1,bf
  FOR i=1 TO 18
    FOR j=1 TO 18
      IF Team$(i)=MN$(j) THEN
        LOCATE 9+i,2
        PRINT USING "##. ";i;
        PRINT "(";
        PRINT USING "##. ";j;
        PRINT ")   ";
        PRINT Team$(i); TAB(37)
        PRINT USING "## ";TPUN(i);
        PRINT ":";
        PRINT USING "##   ";TGP(i);
        PRINT USING "## ";TBT(i);
        PRINT ":";
        PRINT USING "##  ";TGE(i);
        PRINT USING "###";TBD(i);
        PRINT "     ";
        PRINT "(";:PRINT USING "##";H(i);:PRINT ")";:PRINT "  ";
        PRINT "(";:PRINT USING "##";K(i);:PRINT ")";:PRINT "  ";
        PRINT "(";:PRINT USING "##";L(i);:PRINT ")"
      END IF 
    NEXT j
  NEXT i
  
  COLOR 1,0
  GOSUB warten
  IF Tabaus=1 THEN RETURN
  
  FOR i=1 TO 18
    IF Team$(i)=E$(1) THEN Vaplatz=i
  NEXT i
  FOR i=1 TO 18
    IF zu$(i)="verletzt" THEN
      zu(i)=zu(i)-1
      IF zu(i)=0 THEN zu$(i)="OK":GOTO HOSPI
      IF zu(i)>0 THEN GOTO HOSPI
    END IF
    IF zu$(i)="Spital" THEN GOTO HOSPI
    IF zu$(i)="Rote Karte" AND rote<1 THEN rote=rote+1:GOTO HOSPI
    zu$(i)="OK"
    
    HOSPI:
    
  NEXT i
  
THO:

  CLS:GOSUB USCH:LOCATE 3,28
  PRINT "S T A T U S B E R I C H T"
  LINE ( 16, 55)-(300,130),2,bf
  LINE (  6, 50)-(290,125),3,bf
  LINE ( 16,158)-(300,233),2,bf
  LINE (  6,153)-(290,228),5,bf
  LINE (330, 55)-(620,130),2,bf
  LINE (320, 50)-(610,125),6,bf
  LINE (330,158)-(620,233),2,bf
  LINE (320,153)-(610,228),4,bf
  
  zu=2:GOSUB zufalleins
  IF z=0 THEN WETTER=1
  IF z=1 THEN WETTER=2
  IF z=2 THEN WETTER=3
  HALLO=0
  
WETTERBER:

  FOR i=1 TO 18
    IF Team$(a(i))=E$(1) THEN HALLO=a(i)
  NEXT i
  IF           HALLO=1 THEN WETTER=3
  IF           HALLO=2 THEN WETTER=3
  IF           HALLO=3 THEN WETTER=3
  IF sp>26 AND HALLO=4 THEN WETTER=3
  IF sp>26 AND HALLO=5 THEN WETTER=3
  HALLO=0
  LOCATE  8, 2:COLOR 2,3:PRINT "KONDITION:"
  LOCATE 10, 9:          PRINT "Ihre Spieler verlieren"
  LOCATE 12,12:          PRINT "um den Faktor ";WETTER
  LOCATE 14,14:          PRINT "an Leistung !"
  LOCATE 21,42:COLOR 2,4:PRINT "VERLETZUNG:"
  LOCATE  8,42:COLOR 2,6:PRINT "GELBE KARTE:"
  IF GESCHOSS<1 THEN LOCATE 21,2:COLOR 2,5:PRINT "Kein Tor":GOTO Nichtwich
  IF GESCHOSS<2 THEN LOCATE 21,2:COLOR 2,5:PRINT "TOR:"    :GOTO TORkoenige
                     LOCATE 21,2:COLOR 2,5:PRINT "TORE:" 
  
TORkoenige:

  FOR i=1 TO GESCHOSS
    
    Giltnicht:
    
    zu=11:GOSUB zufallszahl
    IF zu$(i)<>"OK" THEN GOTO Giltnicht
    LOCATE 22+i,2
    PRINT na$(z);:TORKO(z)=TORKO(z)+1:PRINT TAB(27):PRINT "(";:PRINT USING "##";TORKO(z);:PRINT ".)"
  NEXT i
  
Nichtwich:

  GESCHOSS=0
  FOR i=1 TO 11
    IF ko(i)=0 THEN GOTO isnich
    IF zu$(i)="verliehen" THEN GOTO isnich
    ko(i)=ko(i)-WETTER
    
    isnich:
    
  NEXT i
  FOR i=12 TO 18
    IF ko(i)=0             THEN GOTO datgehtnich
    IF zu$(i)="verliehen"  THEN GOTO datgehtnich
    IF zu$(i)="gesperrt"   THEN GOTO datgehtnich
    IF zu$(i)="Rote Karte" THEN GOTO datgehtnich
    IF ko(i)<=99           THEN ko(i)=ko(i)+3
    IF ko(i)>100           THEN ko(i)=100
    
    datgehtnich:
    
  NEXT i
  FOR i=2 TO 18
    zu=2:GOSUB zufalleins
    IF z=0 THEN kn(i)=kn(i)-6
    IF z=1 THEN kn(i)=kn(i)-12
    IF z=2 THEN kn(i)=kn(i)-21
  NEXT i
  
  zu=8:GOSUB zufallszahl:Plfak=z
  IF Ueok=1 THEN
    zu=9:GOSUB zufallszahl:Plfak=z
  END IF
  IF z=0 THEN Plfak=1
  IF sp>=6 AND Vaplatz>=14 THEN Plfak=1
  FOR i=1 TO Plfak
    
    dasuebenwirnoch:
    
    zu=2:GOSUB zufallszahl
    Neuez=z
    IF z=0 THEN GOTO dasuebenwirnoch
    
    Nochmalziehen:
    
    zu=18:GOSUB zufallszahl
    IF z=1 THEN GOTO Nochmalziehen
    Neuezzw=z
    IF Neuez=1 AND ka(Neuezzw)>=23 THEN GOTO Nochmalziehen
    IF Neuez=2 AND ka(Neuezzw)>=23 THEN GOTO Nochmalziehen
    IF sp<=4 AND Neuez=1 AND ka(Neuezzw)>=20 THEN GOTO Nochmalziehen
    IF sp<=4 AND Neuez=2 AND ka(Neuezzw)>=20 THEN GOTO Nochmalziehen
    IF Neuez=1 THEN ka(Neuezzw)=ka(Neuezzw)+1
    IF Neuez=2 THEN ka(Neuezzw)=ka(Neuezzw)+1
  NEXT i
  IF sp=ROTKAR THEN GOTO Karten
  zu=3:GOSUB zufalleins
  IF z=2 THEN GOTO ABRECHNUNG1
  IF z=0 THEN GOTO Karten
  IF z=1 THEN zu=10
  IF z=3 THEN GOTO Karten
  IF sp>=5  AND Vaplatz >=13 THEN GOTO ABRECHNUNG1
  zaelerverletzt=0
  FOR i=1 TO 18
    IF zu$(i)="verletzt" THEN zaelerverletzt=zaelerverletzt+1
  NEXT i
  IF zaelerverletzt>=2 THEN GOTO THFROESE
  
Invalide:

  z=0:RANDOMIZE TIMER
  z=1+INT(RND*(zu)+.5)
  
  IF zu$(z)="verliehen"  THEN GOTO Invalide
  IF zu$(z)="verletzt"   THEN GOTO Invalide
  IF zu$(z)="Rote Karte" THEN GOTO Invalide
  IF zu$(z)="Spital"     THEN GOTO Invalide
  
  COLOR 2,4:LOCATE 23,42:PRINT na$(z)
  zu$(z)="verletzt":verz=z
  zu=1:GOSUB zufalleins
  IF z=0 THEN zu(verz)=2
  IF z=1 THEN zu(verz)=1
  IF Vaplatz>=9 THEN zu(verz)=1
  LOCATE 23,65:PRINT zu(verz);:PRINT "Sp."
  zu=1:GOSUB zufalleins
  IF z=0 THEN GOTO THFROESE
  
Invali2:

  z=0:zu=10:RANDOMIZE TIMER
  z=1+INT(RND*(zu)+.5)
  
  IF zu$(z)="verliehen"  THEN GOTO Invali2
  IF zu$(z)="verletzt"   THEN GOTO Invali2
  IF zu$(z)="Rote Karte" THEN GOTO Invali2
  IF zu$(z)="Spital"     THEN GOTO Invali2
  
  LOCATE 25,42:PRINT na$(z)
  zu$(z)="verletzt":verz=z
  zu=1:GOSUB zufalleins
  IF z=1 THEN zu(verz)=2
  IF z=0 THEN zu(verz)=1
  IF Vaplatz>=9 THEN zu(verz)=1
  LOCATE 25,65:PRINT zu(verz);:PRINT "Sp."
  
THFROESE:

  zu=1:GOSUB zufalleins
  IF z=0 THEN GOTO ABRECHNUNG1
  
Karten:

  z=0:zu=10:RANDOMIZE TIMER
  z=1+INT(RND*(zu)+.5)
  
  IF zu$(z)="verliehen"  THEN GOTO Karten
  IF zu$(z)="verletzt"   THEN GOTO Karten
  IF zu$(z)="Rote Karte" THEN GOTO Karten
  GELBE(z)=GELBE(z)+1
  LOCATE 10,42:COLOR 2,6:PRINT na$(z);:PRINT TAB(67):PRINT "( ";:PRINT USING "#";GELBE(z);:PRINT ":)"
  IF GELBE(z)=2 THEN zu$(z)="gesperrt":LOCATE 13,42:PRINT "SPERRUNG:":LOCATE 13,52:PRINT na$(z):GELBE(z)=0
  
Kartenrot:

  IF sp=ROTKAR THEN
    z=0:zu=10:RANDOMIZE TIMER
    z=1+INT(RND*(zu)+.5)
    
    IF zu$(z)="verliehen" THEN GOTO Kartenrot
    IF zu$(z)="gesperrt"  THEN GOTO Kartenrot
    IF fa(z)<3            THEN GOTO Kartenrot
    LOCATE 15,42:PRINT "ROTE KARTE:":LOCATE 15,54:PRINT na$(z)
    zu$(z)="Rote Karte"
  END IF

ABRECHNUNG1:

  COLOR 1,0
  GOSUB warten
  FOR i=1 TO 11
    IF ko(i)<76 AND na$(i)<>"" THEN sonstiges=1
  NEXT i
  FOR i=1 TO 18
    IF TORKO(i)>3 AND STOPPER(i)=0 THEN sonstiges=1
  NEXT i
  
  IF sonstiges=0 THEN GOTO nichtnotwen
  CLS:GOSUB USCH:sonstiges=0:LOCATE 3,35:PRINT "A C H T U N G"
  LINE (190, 55)-(470,130),2,bf
  LINE (180, 50)-(460,125),5,bf
  LOCATE  8,SeasonManager.NUMBER_OF_GAME_DAYS:COLOR 2,5:PRINT "FAKTORERH�HUNG:"
  LINE (190,158)-(470,233),2,bf
  LINE (180,153)-(460,228),4,bf
  LOCATE 21,SeasonManager.NUMBER_OF_GAME_DAYS:COLOR 2,4:PRINT "KONDITIONSGEFAHR:"
  FOR i=1 TO 18
    IF STOPPER(i)=1 THEN GOTO NICHTTWICE
    IF TORKO(i)>3 THEN
      fa(i)=fa(i)+1:STOPPER(i)=1:COLOR 2,5
      LOCATE 10+zeilenvor,SeasonManager.NUMBER_OF_GAME_DAYS:zeilenvor=zeilenvor+1:PRINT na$(i):mf=mf+3
    END IF
    
    NICHTTWICE:
    
  NEXT i
  zeilenvor=0
  FOR i=1 TO 18
    IF i<12 AND ko(i)<76 AND na$(i)<>"" THEN GOSUB KONMEL
    IF ko(i)<70 AND na$(i)<>"" THEN zu$(i)="Spital":IARSCH(i)=1
  NEXT i
  zeilenvor=0:COLOR 1,0:sonstiges=0
  GOSUB warten
  
nichtnotwen:

  GOSUB Zufaelligkeit
  CLS:GOSUB MITTIG:LOCATE 14,31
  PRINT "EINEN MOMENT BITTE...":COLOR 1,0
  WHILE TOTOTIPPEN=1
    IF GEWINN<5 THEN KGEW$="Kein Gewinn":MONEYHON=0:GOTO ABRECHNUNG2
    FOR i=1 TO 17 STEP 2
      HTOT=HTOT+a(i)
      HTOT2=HTOT2+a(i+1)
    NEXT i
    IF HTOT<HTOT2 THEN MUL6=MONETE*2      :MUL7=MONETE*3      :MUL8=MONETE*4       :MUL9=MONETE*5
    IF HTOT=HTOT2 THEN MUL6=MONETE*2+5000 :MUL7=MONETE*3+10000:MUL8=MONETE*4+15000&:MUL9=MONETE*5+20000&
    IF HTOT>HTOT2 THEN MUL6=MONETE*2+10000:MUL7=MONETE*3+20000:MUL8=MONETE*4+25000&:MUL9=MONETE*5+35000&
    IF GEWINN=5 THEN MONEYHON=MONETE
    IF GEWINN=6 THEN MONEYHON=MONETE+MUL6
    IF GEWINN=7 THEN MONEYHON=MONETE+MUL7
    IF GEWINN=8 THEN MONEYHON=MONETE+MUL8
    IF GEWINN=9 THEN MONEYHON=MONETE+MUL9
    mf=mf+3
    HTOT=0:HTOT2=0:MONETE=0
    GOTO ABRECHNUNG2
  WEND
  
ABRECHNUNG2:

  GOSUB LWBerechnung
  FOR i=1 TO 18
    LONGES=LONGES+Lohnmo(i)
  NEXT i
  Varia=Vaplatz
  Vari=19-Varia:GRMIETE=Vari*2000
  IF ka<0        THEN KREDI=8000
  IF ka<=-25000  THEN KREDI=15000
  IF ka<=-35000& THEN KREDI=20000
  IF ka<=-50000& THEN KREDI=25000
  MINUSGES=LOHNGES+kd+KREDI+GRMIETE
  FOR i=1 TO 17 STEP 2
    IF TE$(a(i))=E$(1) THEN ZUVA2=a(i+1)
    IF TE$(a(i+1))=E$(1) THEN ZUVA2=a(i)
  NEXT i
  FOR i=1 TO 18
    IF MN$(i)=E$(    1) THEN ZUpl1=i
    IF MN$(i)=E$(ZUVA2) THEN ZUpl2=i
  NEXT i
  GESZ=ZUpl1+ZUpl2
  
  IF GESZ>30 THEN ZUSCHAU=va-40000&
  IF GESZ<30 THEN ZUSCHAU=va-30000
  IF GESZ<25 THEN ZUSCHAU=va-20000
  IF GESZ<20 THEN ZUSCHAU=va-15000
  IF GESZ<15 THEN zu=10:GOSUB zufallszahl:ZUSCHAU=va-z*1000
  IF GESZ<10 THEN zu=7 :GOSUB zufallszahl:ZUSCHAU=va-z*1000
  IF GESZ<5  THEN ZUSCHAU=va
  
  FOR i=1 TO 17 STEP 2
    IF TE$(a(i+1))=E$(1) THEN KEINH=1:GOTO KEINHEIM
  NEXT i
  EINAH=ZUSCHAU*3
  
KEINHEIM:

  zu=10:GOSUB zufallszahl
  SPEN=z*1000
  IF sp>=9 AND Varia>=11 THEN SPEN=SPEN+10000
  IF Varia=1 THEN BONUSP=5000
  Varia=0
  PLUSGES=EINAH+SPEN+MONEYHON+BONUSP
  kat=ka:ka=ka+PLUSGES-MINUSGES
  CLS:COLOR 0,1
  
  LINE ( 20, 16)-(148, 33),2,bf
  LINE ( 10, 11)-(138, 28),4,bf
  LINE (200, 16)-(620, 71),2,bf
  LINE (190, 11)-(610, 66),1,bf
  LINE ( 20, 88)-(148,105),2,bf
  LINE ( 10, 83)-(138,100),5,bf
  LINE (200, 88)-(620,143),2,bf
  LINE (190, 83)-(610,138),1,bf
  LINE ( 20,160)-(148,177),2,bf
  LINE ( 10,155)-(138,172),6,bf
  LINE (200,160)-(620,208),2,bf
  LINE (190,155)-(610,203),1,bf
  LINE (200,225)-(395,240),2,bf
  LINE (190,220)-(385,235),1,bf
  LINE (415,225)-(620,240),2,bf
  LINE (405,220)-(610,235),1,bf
  
  LOCATE 3,5: COLOR 2,4:PRINT "1. Ausgaben";: COLOR 0,1
  PRINT             TAB(30):PRINT USING "#######";GRMIETE;: PRINT " DM";:PRINT TAB(44) "Grundmiete"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";LOHNGES;: PRINT " DM";:PRINT TAB(44) "Lohnkosten"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";kd;:      PRINT " DM";:PRINT TAB(44) "Ereignis"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";KREDI;:   PRINT " DM";:PRINT TAB(44) "Kreditzinsen"
  PRINT             TAB(30)             "----------"
  PRINT TAB(28) "=" TAB(30):PRINT USING "#######";MINUSGES;:PRINT " DM";:PRINT TAB(44) "Gesamt"
  
  LOCATE 12,5:COLOR 2,5:PRINT "2. Einnahmen";:COLOR 0,1
  IF KEINH=1 THEN PRINT TAB(30):PRINT USING "#######";EINAH;:PRINT " DM";:PRINT TAB(44) "Kein Heimspiel":GOTO ABRECHEINHALB
  PRINT             TAB(30):PRINT USING "#######";EINAH;:   PRINT " DM";:PRINT TAB(44) "Zuschauereinnahmen"
  ABRECHEINHALB:
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";SPEN;:    PRINT " DM";:PRINT TAB(44) "Spenden"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";MONEYHON;:PRINT " DM";:PRINT TAB(44) "Tototip"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";BONUSP;:  PRINT " DM";:PRINT TAB(44) "Bonus (1.Platz)"
  PRINT             TAB(30)             "----------"
  PRINT TAB(28) "=" TAB(30):PRINT USING "#######";PLUSGES;: PRINT " DM";:PRINT TAB(44) "Gesamt"
  
  LOCATE 21,5:COLOR 2,6:PRINT "3. Gesamt";:   COLOR 0,1
  PRINT             TAB(30):PRINT USING "#######";kat;:     PRINT " DM";:PRINT TAB(44) "Kapital"
  PRINT TAB(28) "+" TAB(30):PRINT USING "#######";PLUSGES;: PRINT " DM";:PRINT TAB(44) "Einnahmen"
  PRINT TAB(28) "-" TAB(30):PRINT USING "#######";MINUSGES;:PRINT " DM";:PRINT TAB(44) "Ausgaben"
  PRINT             TAB(30)             "----------"
  PRINT TAB(28) "=" TAB(30):PRINT USING "#######";ka;:      PRINT " DM";:PRINT TAB(44) "Kapital"
  PRINT:PRINT:PRINT
  
  IF TOTOTIPPEN=0 THEN PRINT TAB(28):PRINT "Toto: nicht getippt";:PRINT TAB(56)"Zuschauer: ";ZUSCHAU:GOTO ABRECHNUNG3
  PRINT TAB(28):PRINT "Tototip: ";GEWINN;:PRINT " Richtige";:PRINT TAB(56) "Zuschauer: ";ZUSCHAU
  
ABRECHNUNG3:

  kd=0
  Vaplatz=0:MINUSGES=0:LOHNGES=0:KREDI=0:GRMIETE=0
  EINAH=0:ZUSCHAU=0:SPEN=0
  PLUSGES=0:MONEYHON=0:BONUSP=0:kat=0:KEINH=0
  COLOR 1,0
  GOSUB warten
  
  IF ka<0 THEN
    voka=1+voka
    CLS:GOSUB USCH:LOCATE 3,35
    PRINT "A C H T U N G"
    GOSUB MITTIG:LOCATE 14,21
    PRINT" Ihr Kapital war zum";voka;:PRINT "Male unter DM 0.-"
    GOSUB warten:COLOR 1,0
  END IF
  IF voka>=3 THEN
    CLS:GOSUB USCH:LOCATE 3,32
    PRINT "S P I E L E N D E"
    GOSUB MITTIG:LOCATE 14,3
    PRINT "Aufgrund ihrer schlechten Finanzpolitik werden Sie vom Manageramt enthoben"
    GOSUB warten:COLOR 1,0:GOTO THEEND
  END IF
  IF sp=SeasonManager.NUMBER_OF_GAME_DAYS THEN COLOR 1,0:GOTO THEEND
  CLS:GOSUB USCH:LOCATE 3,33
  PRINT "A N G E B O T E"
  VerleihSp=0:KaufSp=0:VerkaufSP=0
  zu=2:GOSUB zufallszahl
  IF z=2 THEN
    LINE (20,70)-(620,90),2,bf
    LINE (10,65)-(610,85),1,bf
    LOCATE 10,18
    PRINT "Es wird ihnen ein Spieler zum Kauf angeboten":KaufSp=1
  END IF
  
  IF ka<=0 THEN
    LINE (20,102)-(620,122),2,bf
    LINE (10, 97)-(610,117),1,bf
    LOCATE 14,14
    PRINT "Sie haben die M�glichkeit einen Spieler zu verkaufen":VerkaufSP=1
    GOTO isterledigt1
  END IF
  
  zu=2:GOSUB zufallszahl
  IF z=2 THEN
    LINE (20,102)-(620,122),2,bf
    LINE (10, 97)-(610,117),1,bf
    LOCATE 14,14
    PRINT "Sie haben die M�glichkeit einen Spieler zu verkaufen":VerkaufSP=1
  END IF
  
  zu=2:GOSUB zufallszahl
  IF z=2 THEN 
    LINE (20,1SeasonManager.NUMBER_OF_GAME_DAYS)-(620,154),2,bf
    LINE (10,129)-(610,149),1,bf
    LOCATE 18,12
    PRINT "Ein Spieler kann zum n�chsten Spieltag verliehen werden":VerleihSp=1
    GOTO ister2
  END IF
  
isterledigt1:

  IF ka<=0 THEN 
    LINE (20,1SeasonManager.NUMBER_OF_GAME_DAYS)-(620,154),2,bf
    LINE (10,129)-(610,149),1,bf
    LOCATE 18,12
    PRINT "Ein Spieler kann zum n�chsten Spieltag verliehen werden":VerleihSp=1
  END IF
  
ister2:

  LINE (230,190)-(430,210),2,bf
  LINE (220,185)-(420,205),1,bf
  LOCATE 25,38
  PRINT "Taste":COLOR 1,0
  GOSUB warten
  sp=sp+1:bms=1:TOTOTIPPEN=0:GEWINN=0:SPPA=0
  IF sp=10 THEN GOSUB S2
  IF sp=18 THEN GOSUB S1
  IF sp=27 THEN GOSUB S2
  IF sp= 2 OR sp=10 OR sp=18 OR sp=27 THEN pu=18
  IF sp=10 OR sp=18 OR sp=27 THEN GOTO S5
  FOR i=1 TO 18
    pu=pu+1
    a(i)=a(pu)
  NEXT i
  
S5:  
  
  IF sp>=18 THEN
    FOR i=1 TO 17 STEP 2
      SWAP a(i),a(i+1)
    NEXT i
  END IF
  
S6:

  WHILE sp=18
    FOR i=2 TO 18
      kn(i)=1080
    NEXT i
    FOR i=1 TO 18
      IF na$(i)<>"" THEN ko(i)=100
    NEXT i
    GOTO STADIFRA
  WEND
  
STADIFRA:

  WHILE FERTIG=sp
    bmst=0
    va=va+PP
    CLS:GOSUB MITTIG:LOCATE 14,27
    PRINT "Stadionausbau fertiggestellt":COLOR 1,0
    GOSUB warten
    GOTO SCHLUSSWEI
  WEND
  
SCHLUSSWEI:

  GOTO MANAGERMARKT
  
VERGLEICHEN:

  IF TBD(j)<TBD(i) THEN
    SWAP TBD(i),  TBD(j)
    SWAP TP(i),   TP(j)
    SWAP TBT(i),  TBT(j)
    SWAP Team$(i),Team$(j)
    SWAP TGE(i),  TGE(j)
    SWAP TGP(i),  TGP(j)
    SWAP TPUN(i), TPUN(j)
    SWAP H(i),    H(j)
    SWAP K(i),    K(j)
    SWAP L(i),    L(j)
  END IF
  
  IF TBD(j)=TBD(i) THEN GOSUB ver2
  
  RETURN
  
ver2:

  IF TBT(j)<TBT(i) THEN
    SWAP TBT(i),  TBT(j)
    SWAP TP(i),   TP(j)
    SWAP TBD(i),  TBD(j)
    SWAP Team$(i),Team$(j)
    SWAP TGE(i),  TGE(j)
    SWAP TGP(i),  TGP(j)
    SWAP TPUN(i), TPUN(j)
    SWAP H(i),    H(j)
    SWAP K(i),    K(j)
    SWAP L(i),    L(j)
  END IF
  
  RETURN
  
KONMEL:

  COLOR 2,4:LOCATE 23+zeilenvor,SeasonManager.NUMBER_OF_GAME_DAYS
  PRINT na$(i);:PRINT TAB(52):PRINT ko(i);:PRINT "%"
  zeilenvor=zeilenvor+1
  
  RETURN
  
THEEND:

  COLOR 1,0
  CLS:GOSUB MITTIG:LOCATE 14,29
  PRINT "S A I S O N E N D E !":mfneu=mf
  FOR i=15 TO 1 STEP -1
    KNETq=50000&*i
    IF ka>=KNETq THEN GOTO THATsIT
  NEXT i
  
THATsIT:

  KNET=i*3:mf=mf+KNET
  IF ka<0 THEN mf=mf-10:KNET=-10
  
  IF va >= 90000& THEN mf=mf+75:tz=75:GOTO THATSITTWO
  IF va >= 80000& THEN mf=mf+50:tz=50:GOTO THATSITTWO
  IF va >= 70000& THEN mf=mf+25:tz=25:GOTO THATSITTWO
  IF va >= 60000& THEN mf=mf+ 5:tz= 5:GOTO THATSITTWO
  
THATSITTWO:

  FOR i=1 TO 18
    IF Team$(a(i))=E$(1) THEN HALLO=a(i)
  NEXT i
  IF HALLO=1 THEN mf=mf+150:ti=150:GOTO THATTHREE
  IF HALLO=2 THEN mf=mf+75 :ti=75 :GOTO THATTHREE
  IF HALLO=3 THEN mf=mf+50 :ti=50 :GOTO THATTHREE
  IF HALLO=4 THEN mf=mf+25 :ti=25 :GOTO THATTHREE
  IF HALLO=5 THEN mf=mf+17 :ti=17 :GOTO THATTHREE
  FOR i=6 TO 15
    IF HALLO=i THEN RATEM=18-i:ti=RATEM
  NEXT i
  mf=mf+RATEM
  
THATTHREE:

  IF HALLO=1 AND voka<3 THEN
    CLS:GOSUB MITTIG:LOCATE 14,5
    PRINT "Gl�ckwunsch, Sie sind mit Ihrem Team Deutscher Meister geworden !"
    GOSUB warten
  END IF
  COLOR 1,0:CLS:GOSUB USCH:LOCATE 3,28
  PRINT "E N D A B R E C H N U N G"
  LINE (90,48)-(550,195),2,bf
  LINE (80,43)-(540,190),1,bf
  
  LOCATE 9,10
  PRINT TAB(21):PRINT "  Managerpunkte bisher:    ";mfneu;:PRINT TAB(54):PRINT "Punkte":PRINT
  PRINT TAB(21):PRINT "+ Stadionausbau:           ";tz;:   PRINT TAB(54):PRINT "Punkte":PRINT
  PRINT TAB(21):PRINT "+ Tabellenplatz:           ";ti;:   PRINT TAB(54):PRINT "Punkte":PRINT
  PRINT TAB(21):PRINT "+ Restkapital:             ";KNET;: PRINT TAB(54):PRINT "Punkte":PRINT
  PRINT TAB(21):PRINT "---------------------------------------":PRINT
  PRINT TAB(21):PRINT "= Managerpunkte gesamt:    ";mf;:   PRINT TAB(54):PRINT "Punkte":PRINT
  
  LINE (260,216)-(390,231),2,bf
  LINE (250,212)-(380,227),1,bf
  LOCATE 28,38:PRINT "Taste":COLOR 1,0
  GOSUB warten
  CLS:GOSUB MITTIG:LOCATE 14,27
  PRINT "E N D E       Bis dann..."
  END
  GOTO TOPIC
  
Teingabe:

  GOTO MANAGERMARKT
  
Schan:

  FOR Zeit=1 TO 7000
  NEXT Zeit
  
  RETURN
  
USCH:

  COLOR 0,1
  LINE (190,10)-(470,35),2,bf
  LINE (180, 5)-(460,30),1,bf
  
  RETURN
  
Farben:

  PALETTE 0, .4, .4, .4
  PALETTE 1, .6, .6, .6
  PALETTE 2,  0,  0,  0
  PALETTE 4,.93, .2,  0
  PALETTE 5, .6,  1, .1
  PALETTE 6,  1,  1,  0
  PALETTE 3,.47,.87,  1
  PALETTE 7,  1,  1,  1
  
  RETURN
  
slope:

  LOCATE 9,26:PRINT SPACE$(29):LOCATE 9,38:PRINT SPACE$(10)
  IF ih>0 THEN jh=0:FOR jh=1 TO 1000:NEXT jh
  IF ih=0 THEN 
    LOCATE 10,SeasonManager.NUMBER_OF_GAME_DAYS:PRINT SPACE$(2)
    LOCATE 11,26:PRINT SPACE$(9)
    LOCATE 11,SeasonManager.NUMBER_OF_GAME_DAYS:PRINT USING "##";w-1;:PRINT ".Spielminute     "
  END IF 
  
  RETURN
  
MITTIG:

  COLOR 0,1
  LINE (20,99)-(620,119),2,bf
  LINE (10,94)-(610,114),1,bf
  
  RETURN
  
warten:

  a$=INKEY$
  IF a$="" THEN warten
  
  RETURN

Abfrageschleife:

  Bes$=INKEY$:IF Bes$<>"" THEN Bes$=UCASE$(Bes$)
  IF Bes$="J" THEN Bes$="":GOTO veri
  IF Bes$="N" THEN Bes$="":GOTO negi
  RETURN
  
veri:
  
  ON ver GOTO Roger1,Roger2,Roger3,Roger4,Roger5,Roger6

negi:
  
  ON neg GOTO Noger1,Noger2,Noger3,Noger4,MANAGERMARKT,MANAGERMARKT
  
minusto:

  z=0:mito=0
  IF TOR >-5 AND TOR <=-3 THEN zu=7:GOSUB zufallszahl1
  IF TOR >-3              THEN zu=4:GOSUB zufallszahl1
  IF z=2 THEN mito=1
  
  RETURN

plusto:

  plto=0
  IF TOR<3 THEN   
    zu=3:GOSUB zufallszahl1
    IF z=3           THEN plto=1
    IF z=3 AND TOR=2 THEN plto=2
    IF z=2           THEN plto=1
  END IF
  IF TOR=3 THEN
    zu=4:GOSUB zufallszahl
    IF z=3 OR z=4 THEN plto=2
    IF z=2        THEN plto=1
  END IF
  IF TOR=4 THEN
    zu=5:GOSUB zufallszahl1
    IF z=5        THEN plto=3
    IF z=3 OR z=4 THEN plto=2
    IF z=2        THEN plto=1
  END IF
  IF TOR=5 THEN
    zu=6:GOSUB zufallszahl
    IF z=6        THEN plto=4
    IF z=4 OR z=5 THEN plto=3
    IF z=3        THEN plto=2
    IF z=2        THEN plto=1
  END IF
  IF TOR>5 THEN
    zu=7:GOSUB zufallszahl
    IF z>4           THEN plto=4:GOTO plback
    IF z>2 AND z<5   THEN plto=3:GOTO plback
                          plto=2
    IF TOR=6 AND z=2 THEN plto=0
    IF TOR=7 AND z=2 THEN plto=1
  END IF
  
plback:

  RETURN
  
zufalleins:

  z=0:RANDOMIZE TIMER
  z=0+INT(RND*(zu)+.5)
  
  RETURN
  
zufallszahl:

  z=0:RANDOMIZE TIMER
  z=1+INT(RND*(zu)+.5)
  
  RETURN
  
zufallszahl1:

  z=0:RANDOMIZE TIMER
  z=1+INT(RND*(zu)+.5)
  
  RETURN
  
U1:

  DATA "Borussia Dortmund","Werder Bremen","Bayern M�nchen","1. FC K�ln"
  DATA "Dynamo Dresden","1. FC N�rnberg","VFB Stuttgart","Hamburger SV"
  DATA "Borussia Mgladbach","Bayer Leverkusen","Eintracht Frankfurt"
  DATA "Karlsruher SC","1. FC Kaiserslautern","Wattenscheid 09"
  DATA "FC Schalke 04","VFL Bochum","Bayer Uerdingen","1. FC Saarbruecken"
  
  FOR i=1 TO 18
    READ E$(i)
  NEXT i
  
U3:

  DATA "Brehme","Abwehr","Wheelan","Mittelfeld","Altobelli","Angriff"
  DATA "Michel","Abwehr","Butragueno","Mittelfeld","Vialli","Angriff"
  DATA "Dassajew","Torwart","Koeman","Abwehr","Matthaeus","Mittelfeld"
  DATA "Protassow","Angriff","Rijkaard","Abwehr","Gullit","Mittelfeld"
  DATA "van Basten","Angriff"
  
  FOR i=1 TO 13
    READ Vna$(i),Vpo$(i)
  NEXT i
  
U4:

  DATA 3,3,3,4,4,4,5,5,5,5,6,6,6
  
  FOR i=1 TO 13
    READ Vfa(i)
  NEXT i
  
U5:
  
  DATA 17,16,1080,17,16,1080,17,16,1090,17,16,1095,16,16,1100,16,16,1100
  DATA 16,17,1080,16,17,1080,16,17,1090,16,17,1085,17,17,1065
  DATA 17,17,1065,18,15,1080,15,18,1080,15,18,1085,15,18,1085,18,15,1085
  
  FOR i=2 TO 18
    READ ka(i),ks(i),kn(i)
  NEXT i
  
U6:

  DATA 4,3,3,4,2,3,4,2,2,2,4,2,2,2,2,2
  FOR i=1 TO 16
    READ fa(i)
  NEXT i

U7:

  DATA "Teddy de Beer","Torwart","Mc Leod","Abwehr","Rul�nder","Abwehr"
  DATA "Kutowski","Abwehr","Pagelsdorf","Abwehr","M�ller","Mittelfeld"
  DATA "Rummenigge","Angriff","Zorc","Mittelfeld","Dickel","Angriff"
  DATA "Kroth","Mittelfeld","Mill","Angriff"
  DATA "Lusch","Abwehr","Meyer","Torwart","Breitzke","Angriff"
  DATA "Nikolic","Angriff","Storck","Abwehr"
  
  FOR i=1 TO 16
    READ na$(i),po$(i)
  NEXT i
  
S1:

  stl=162:GOSUB Sl
  DATA 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18
  DATA 4,1,14,11,18,15,12,9,10,7,8,5,6,3,2,17,16,13
  DATA 1,6,3,8,5,10,7,12,9,14,11,16,13,18,2,4,17,15
  DATA 12,5,18,11,14,7,10,3,8,1,6,2,4,17,15,13,16,9
  DATA 1,10,3,12,5,14,7,16,9,18,11,15,4,6,2,8,17,13
  DATA 18,7,14,3,12,1,10,2,8,4,6,17,13,11,15,9,16,5
  DATA 1,14,3,16,5,18,7,15,9,13,6,8,4,10,2,12,17,11
  DATA 12,4,18,3,14,2,10,6,8,17,11,9,13,7,15,5,16,1
  DATA 1,18,3,15,5,13,7,11,6,12,8,10,4,14,2,16,17,9
  
  RETURN
  
S2:

  stl=144:GOSUB Sl
  DATA 15,1,18,2,14,6,12,8,10,17,9,7,11,5,13,3,16,4
  DATA 1,13,3,11,5,9,10,12,8,14,6,16,4,18,2,15,17,7
  DATA 18,6,14,10,12,17,7,5,9,3,11,1,13,2,15,4,16,8
  DATA 1,9,3,7,12,14,10,16,8,18,6,15,4,13,2,11,17,5
  DATA 18,10,14,17,5,3,7,1,9,2,11,4,13,6,15,8,16,12
  DATA 1,5,3,17,12,18,10,15,8,13,6,11,4,9,2,7,16,14
  DATA 18,14,3,1,5,2,7,4,9,6,11,8,13,10,15,12,17,16
  DATA 1,17,14,15,12,13,10,11,8,9,6,7,4,5,2,3,16,18
  
  RETURN
  
Sl:

  IF sp=18 THEN
    RESTORE S1
    FOR i=1 TO 162
      READ a(i)
    NEXT i
    RETURN
  END IF
  IF sp=27 THEN
    RESTORE S2:
    FOR i=1 TO 144
      READ a(i)
    NEXT i
    RETURN
  END IF
  FOR i=1 TO stl
    a(i)=0
  NEXT i
  FOR i=1 TO stl
    READ a(i)
  NEXT i 
  
  RETURN
  
  
 
  
    
                
